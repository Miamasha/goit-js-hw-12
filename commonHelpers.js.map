{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport axios from \"axios\";\n\nlet key = '41863553-31a4ca98ea592d85823201a44'\nvar lightbox = new SimpleLightbox('.gallery a', {captionsData: 'alt', captions: true, captionPosition: 'bottom', captionDelay: 250,});\n\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader-container\"); \nconst form = document.querySelector('.search-form');\nconst loadMoreButton = document.querySelector(\".load-more-button\");\n\nlet page = 1;\nlet lastSearchText = '';\n\nform.addEventListener('submit', async (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    gallery.innerHTML = '';\n    let searchText = form.elements[\"searchText\"].value;\n    if (lastSearchText === searchText) {\n        page = page + 1;\n    } else {\n        page = 1;\n    }\n\n    lastSearchText = searchText;\n    await loadFromPixabay(searchText, page).then((response) => {\n        const jsonData = response.data;\n        if (jsonData.hits.length === 0){\n            iziToast.warning({message: 'Sorry, there are no images matching your search query. Please try again!', position: 'topRight'});\n        }\n\n        if(jsonData.totalHits < page * 40){\n            loadMoreButton.style.display = 'none';\n        } else { \n            loadMoreButton.style.display = 'block';\n        }\n        \n        loader.style.display = 'none';\n        const markup = galleryMarkup(jsonData);\n        gallery.innerHTML = markup;\n        lightbox.refresh();\n    })\n    .catch((error) => {\n        loader.style.display = 'none';\n        iziToast.error({ message: error.message, position: 'topRight' });\n    })\n});\n\nloadMoreButton.addEventListener('click', async () => {\n    page = page + 1;\n\n    await loadFromPixabay(lastSearchText, page).then((response) => {\n        const jsonData = response.data;\n        if (jsonData.hits.length === 0){\n            loadMoreButton.style.display = 'none';\n        } else if(jsonData.totalHits < page * 40){\n            loadMoreButton.style.display = 'none';\n        } else { \n            loadMoreButton.style.display = 'block';\n        }\n        \n        loader.style.display = 'none';\n\n        const markup = galleryMarkup(jsonData);\n        gallery.innerHTML += markup;\n\n        const galleryItem = document.querySelector(\".gallery li\");\n        window.scrollBy({ top: galleryItem.getBoundingClientRect().height * 2})\n        \n        lightbox.refresh();\n    })\n    .catch((error) => {\n        loader.style.display = 'none';\n        iziToast.error({ message: error.message, position: 'topRight' });\n    })\n})\n\nasync function loadFromPixabay(search, page){\n    loader.style.display = 'block';\n    return await axios({\n        method: 'get',\n        url: `https://pixabay.com/api/?key=${key}&q=${search}&page=${page}&per_page=40&image_type=photo&orientation=horizontal&safesearch=true`\n    });\n}\n\nfunction galleryMarkup(jsonData){\n    return jsonData.hits\n            .map((image) => `\n                <li class=\"gallery-item\">\n                    <a \n                    class=\"gallery-link\" \n                    href=\"${image.largeImageURL}\"      \n                    >\n                        <img\n                        class=\"gallery-image\"\n                        src=\"${image.previewURL}\"\n                        \n                        alt=\"${image.tags}\"\n                        width=\"150\"\n                        height=\"100\"\n                        />\n                    \n                    <ul class=\"gallery-item-info\">\n                        <li>\n                            <div class=\"gallery-item-info-title\">Likes</div>\n                            <div class=\"gallery-item-info-value\">${image.likes}</div>\n                        </li>\n                        <li>\n                            <div class=\"gallery-item-info-title\">Views</div>\n                            <div class=\"gallery-item-info-value\">${image.views}</div>\n                        </li>\n                        <li>\n                            <div class=\"gallery-item-info-title\">Comments</div>\n                            <div class=\"gallery-item-info-value\">${image.comments}</div>\n                        </li>\n                        <li>\n                            <div class=\"gallery-item-info-title\">Downloads</div>\n                            <div class=\"gallery-item-info-value\">${image.downloads}</div>\n                        </li>\n                    </ul></a>\n                </li>\n                `)\n            .join(\"\");\n}\n"],"names":["key","lightbox","SimpleLightbox","gallery","loader","form","loadMoreButton","page","lastSearchText","event","searchText","loadFromPixabay","response","jsonData","iziToast","markup","galleryMarkup","error","galleryItem","search","axios","image"],"mappings":"owBAYA,IAAIA,EAAM,qCACV,IAAIC,EAAW,IAAIC,EAAe,aAAc,CAAC,aAAc,MAAO,SAAU,GAAM,gBAAiB,SAAU,aAAc,GAAK,CAAA,EAEpI,MAAMC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,mBAAmB,EACnDC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAiB,SAAS,cAAc,mBAAmB,EAEjE,IAAIC,EAAO,EACPC,EAAiB,GAErBH,EAAK,iBAAiB,SAAU,MAAOI,GAAU,CAC7CA,EAAM,eAAc,EACpBA,EAAM,gBAAe,EAErBN,EAAQ,UAAY,GACpB,IAAIO,EAAaL,EAAK,SAAS,WAAc,MACzCG,IAAmBE,EACnBH,EAAOA,EAAO,EAEdA,EAAO,EAGXC,EAAiBE,EACjB,MAAMC,EAAgBD,EAAYH,CAAI,EAAE,KAAMK,GAAa,CACvD,MAAMC,EAAWD,EAAS,KACtBC,EAAS,KAAK,SAAW,GACzBC,EAAS,QAAQ,CAAC,QAAS,2EAA4E,SAAU,UAAU,CAAC,EAG7HD,EAAS,UAAYN,EAAO,GAC3BD,EAAe,MAAM,QAAU,OAE/BA,EAAe,MAAM,QAAU,QAGnCF,EAAO,MAAM,QAAU,OACvB,MAAMW,EAASC,EAAcH,CAAQ,EACrCV,EAAQ,UAAYY,EACpBd,EAAS,QAAO,CACxB,CAAK,EACA,MAAOgB,GAAU,CACdb,EAAO,MAAM,QAAU,OACvBU,EAAS,MAAM,CAAE,QAASG,EAAM,QAAS,SAAU,UAAU,CAAE,CACvE,CAAK,CACL,CAAC,EAEDX,EAAe,iBAAiB,QAAS,SAAY,CACjDC,EAAOA,EAAO,EAEd,MAAMI,EAAgBH,EAAgBD,CAAI,EAAE,KAAMK,GAAa,CAC3D,MAAMC,EAAWD,EAAS,KACtBC,EAAS,KAAK,SAAW,GAEnBA,EAAS,UAAYN,EAAO,GADlCD,EAAe,MAAM,QAAU,OAI/BA,EAAe,MAAM,QAAU,QAGnCF,EAAO,MAAM,QAAU,OAEvB,MAAMW,EAASC,EAAcH,CAAQ,EACrCV,EAAQ,WAAaY,EAErB,MAAMG,EAAc,SAAS,cAAc,aAAa,EACxD,OAAO,SAAS,CAAE,IAAKA,EAAY,wBAAwB,OAAS,CAAC,CAAC,EAEtEjB,EAAS,QAAO,CACxB,CAAK,EACA,MAAOgB,GAAU,CACdb,EAAO,MAAM,QAAU,OACvBU,EAAS,MAAM,CAAE,QAASG,EAAM,QAAS,SAAU,UAAU,CAAE,CACvE,CAAK,CACL,CAAC,EAED,eAAeN,EAAgBQ,EAAQZ,EAAK,CACxC,OAAAH,EAAO,MAAM,QAAU,QAChB,MAAMgB,EAAM,CACf,OAAQ,MACR,IAAK,gCAAgCpB,OAASmB,UAAeZ,uEACrE,CAAK,CACL,CAEA,SAASS,EAAcH,EAAS,CAC5B,OAAOA,EAAS,KACP,IAAKQ,GAAU;AAAA;AAAA;AAAA;AAAA,4BAIAA,EAAM;AAAA;AAAA;AAAA;AAAA,+BAIHA,EAAM;AAAA;AAAA,+BAENA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mEAQ8BA,EAAM;AAAA;AAAA;AAAA;AAAA,mEAINA,EAAM;AAAA;AAAA;AAAA;AAAA,mEAINA,EAAM;AAAA;AAAA;AAAA;AAAA,mEAINA,EAAM;AAAA;AAAA;AAAA;AAAA,iBAIxD,EACJ,KAAK,EAAE,CACpB"}